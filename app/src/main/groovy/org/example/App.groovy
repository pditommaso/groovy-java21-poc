/*
 * This source file was generated by the Gradle 'init' task
 */
package org.example

import java.nio.file.Path

import groovy.transform.CompileStatic
import org.codehaus.groovy.control.CompilerConfiguration
import org.codehaus.groovy.control.customizers.ImportCustomizer

@CompileStatic
class App {
    String getGreeting() {
        GroovyShell sh = new GroovyShell(new GroovyClassLoader(), getConfig())
        sh.evaluate('''
        final list = new ArrayList<>()
        list << 'Runtime: Groovy'
        list << GroovySystem.getVersion()
        list << 'on'
        list << System.getProperty('java.vm.name')
        list << System.getProperty('java.runtime.version')
        return list.join(' ')
        ''')
    }

    CompilerConfiguration getConfig() {
        // define the imports
        def importCustomizer = new ImportCustomizer()
        importCustomizer.addImports( Path.name )

        final config = new CompilerConfiguration()
        config.addCompilationCustomizers( importCustomizer )
        config.scriptBaseClass = BaseScript.class.name

        return config
    }

    static void main(String[] args) {
        println new App().greeting
    }
}
